<!DOCTYPE html>
<html>
    <head>
        <title>Successful Login</title>

        <style>
            button {
                padding: 5px;
            }
            #buttonDiv, #logged, #greet {
                text-align: center;
            }
            body{
                background-image: url("images/backdrop2.png");
            }
            .informationDiv{
                width: 80%;
                background-color: white;
                margin: 0 auto;
                padding: 10px;
            }

            .search-container { 
                width: 240px; margin-left:auto; padding: 10px; 
                } 
            .search-input { 
                height: 15px; width: 200px; padding: 5px; margin: 0; border: none; background: white; 
                } 
            .search-button { 
                cursor: pointer; height: 25px; width: 30px; border: none; margin-left: -5px; background: white; 
                }
        </style>


        <script>

            function query(){
                var book = document.getElementById("input");
                console.log(book);
                var xhttp = new XMLHttpRequest();
                
                xhttp.open("get", "bookQuery.php?name="+book, true);
                xhttp.responseType = 'text';
                xhttp.onreadystatechange = function () {
                    if (xhttp.readyState == 4) {
                        if (xhttp.status == 200) {
                            if (xhttp.responseText == "FALSE") {
                                err.innerHTML = "Incorrect Credentials, please try again";
                            } else {
                                // This is jQuery
                                var temp = xhttp.responseText.split(",");
                                localStorage.setItem("user", temp[0]);
                                localStorage.setItem("role", temp[1]);
                                location.href = 'main.html';
                            }
                        }
                    }
                };
                xhttp.send();
            }
            }


            function greeting()  {
                var roles = ["","User", "Other"];
                var greet = document.getElementById("greet");
                var logged = document.getElementById("logged");
                var user = localStorage.getItem("user");
                greet.innerHTML = "Hello " + user;
                logged.innerHTML = "You are logged in as: " + role;
            }


        </script>
    </head>
    <body onload="greeting()">
        <script src="validate.js"></script>
        <h2><div id="greet"></div></h2>
        <p><div id="logged"></div></p>
        <div class="informationDiv"></div>
        <form >
            <div class="search-container"> 
                <input type="text" name="search-text" id="input" class="search-input"/> 
                <button class="search-button" onclick="query()">&#x1F50D</button> 
            </div>
          </form>
    </body>


</html>